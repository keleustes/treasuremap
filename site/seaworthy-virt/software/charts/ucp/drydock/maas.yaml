---
apiVersion: armada.airshipit.org/v1alpha1
kind: ArmadaChart
metadata:
  layeringDefinition:
    abstract: false
    actions:
    - method: merge
      path: .
    layer: site
    parentSelector:
      name: ucp-maas-global
  name: ucp-maas-global
  replacement: true
  substitutions:
  - dest:
      path: .values.conf.ssh.private_key
    src:
      kind: DeckhandCertificateKey
      name: airship_drydock_kvm_ssh_key
      path: .
  - dest:
      path: .values.network.maas_ingress.addr
    src:
      kind: PeglegCommonAddresses
      name: common-addresses
      path: .vip.maas_vip
spec:
  values:
    endpoints:
      maas_ingress:
        port:
          ingress_default_server:
            default: 8182
    manifests:
      secret_ssh_key: true
